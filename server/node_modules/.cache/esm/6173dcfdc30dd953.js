let LOCATION,FISH,TYPES;_c30‍.w("../constants/constants",[["LOCATION",["LOCATION"],function(v){LOCATION=v}],["FISH",["FISH"],function(v){FISH=v}],["TYPES",["TYPES"],function(v){TYPES=v}]]);const feathers = require("@feathersjs/feathers");
const socketio = require("@feathersjs/socketio");
const memory = require("feathers-memory");
const rx = require("feathers-reactive");


const L = TYPES.LOCATION;
const F = TYPES.FISH;

const app = feathers()
  .configure(socketio())
  .configure(
    rx({
      idField: "id",
    })
  )
  .use("/games", memory());

const games = app.service("games");
games.create({
  id: "123",
  players: {
    one: {
      ready: false,
      name: "Amos",
      gold: 90,
      equipment: [],
      fish: null,
      location: null,
    },
    two: {
      ready: false,
      name: "Brian",
      gold: 0,
      equipment: [],
      fish: null,
      location: null,
    },
    // three: {
    //   ready: false,
    //   name: "Carlos",
    //   gold: 0,
    //   equipment: [],
    //   fish: null,
    //   location: null,
    // },
    // four: {
    //   ready: false,
    //   name: "DeAndre",
    //   gold: 0,
    //   equipment: [],
    //   fish: null,
    //   location: null,
    // },
  },
  locations: {
    [L.RIVER]: {
      [F.TROUT]: LOCATION[L.RIVER].fish[F.TROUT].max,
    },
    [L.SHOAL]: {
      [F.TROUT]: LOCATION[L.SHOAL].fish[F.TROUT].max,
      [F.LOBSTER]: LOCATION[L.SHOAL].fish[F.LOBSTER].max,
    },
    [L.DEEP]: {
      [F.SQUID]: LOCATION[L.DEEP].fish[F.SQUID].max,
      [F.TUNA]: LOCATION[L.DEEP].fish[F.TUNA].max,
    },
  },
});

games
  .get("123")
  .watch()
  .subscribe((res) => {
    console.log("update");
    _c30‍.g.console.log(res);
  });

app.on("connection", (connection) => app.channel("everybody").join(connection));
app.publish(() => app.channel("everybody"));

app
  .listen(3030)
  .on("listening", () =>
    console.log("Feathers Socket.io server running on localhost:3030")
  );
